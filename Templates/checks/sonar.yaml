---
parameters:
  - name: buildType

steps:
  - ${{ if eq(parameters.buildType, 'c') }}:
      - task: SonarQubePrepare@5
        displayName: 'Sonar - Analysis Configuration'
        inputs:
          SonarQube: 'SonarQube'
          scannerMode: 'CLI'
          configMode: 'file'
          projectKey: '$(Build.Repository.Name)'

  - ${{ if eq(parameters.buildType, 'dotnet') }}:
      - task: SonarQubePrepare@5
        displayName: 'Sonar - Analysis Configuration'
        inputs:
          SonarQube: 'SonarQube'
          scannerMode: 'MSBuild'
          projectKey: '$(Build.Repository.Name)'
      - task: DotNetCoreCLI@2
        displayName: 'Sonar Dotnet Build'
        inputs:
          command: 'build'
          projects: '**/*.csproj'
          modifyOutputPath: true
          arguments: '--output $(Build.ArtifactStagingDirectory)'

  - task: SonarQubeAnalyze@5
    displayName: 'Sonar - Code Analysis'
    inputs:
      jdkversion: 'JAVA_HOME'

